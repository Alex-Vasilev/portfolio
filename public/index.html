<!DOCTYPE html>
<html>
    <head>
        <link href="https://fonts.googleapis.com/css?family=Catamaran:400,500,700,800,900|Josefin+Sans:100,100i,300,300i,400,400i,600,600i,700,700i|Julius+Sans+One|Maven+Pro:400,500,700,900" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script src="https://unpkg.com/vue@2.1.4/dist/vue.js"></script>
        <script src="https://unpkg.com/vue-router/dist/vue-router.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css">
        <meta name="viewport" content="width=device-width">
        <meta charset="utf-8">
        <title>avawesome</title>
    </head>
    <body>
       <div class="content"
             id="main-page">
             <div class="header">
                 <router-link to="/" class="logo"></router-link>
                <div class="menu-contain">
                     <!--activation--> 
                    <label class="menu" for="modal-1">menu</label>
                     <!--modal window--> 
                    <div class="modal">
                        <input class="modal-open" id="modal-1" type="checkbox" hidden>
                        <div class="modal-wrap" aria-hidden="true" role="dialog">
                            <label class="modal-overlay" for="modal-1"></label>
                            <div class="modal-dialog"> 
                                <div class="modal-body">
                                    <ul class="main-menu">
                                        <li><router-link to="/works">Works</router-link></li>
                                        <li><router-link to="/about">About</router-link></li>
                                        <li><router-link to="/contact">Contact</router-link></li>
                                        <li><router-link to="/blog">Blog</router-link></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

  <!-- отображение компонента, для которого совпал путь -->
  <router-view></router-view>

        </div>

        <script>
            
const Home = { template: `<div class="blog-content home"> 
                <h2>Hello people!<br> <span>My name is Alex and<br>
                        welcome to my fucking great website!</span></h2>
            </div>` };
const Works = { template: `<div class="blog-content">works</div>` };
const Contact = { template: `<div class="blog-content">contact</div>` };
const About = { template: `<div class="blog-content">about</div>` };

const Blog = { template: `<div class="blog-content">
                <h3>latest news</h3>
                <form name="postsForm" @submit.prevent="onSubmit">
                    <input type="hidden" name="id" value="0" />
                    <div class="form-group">
                        <label for="name">Title</label>
                        <input class="form-control"
                               name="name"
                               v-model="name"/>
                    </div>
                    <div class="form-group">
                        <label for="description">Text</label>
                        <input class="form-control"
                               name="description"
                               v-model="description"/>
                    </div>
                    <div class="panel-body">
                        <button type="submit"
                                class="btn btn-sm btn-primary">Save</button>
                        <a id="reset" class="btn btn-sm btn-primary">Cancel</a>
                    </div>
                </form>
                <ul class="news-item-list">
                    <li v-for="item in items"
                        class="news-item">
                        <p class="news-item-title">{{item.name}}</p>
                        <p class="news-item-description">{{item.description}}</p>
                        <button>Edit</button>
                        <button>Delete</button>
                    </li>
                </ul>
            </div>`,
    data: function(){
        return {
            items: [],
            description: '',
            name: ''
        };
    },
    created () {
    this.fethPostsData();
  },
    watch: {
    // в случае изменения маршрута запрашиваем данные вновь
    '$route': 'fetchData'
  },
    methods:{
        fethPostsData: function(){
            console.log(1);
            var self = this;
            $.ajax({
            url: "api/posts",
                    type: "GET",
                    contentType: "application/json",
                    success: function (posts) {
                    self.items = posts;
                    console.log(1);
                },
                error: function(){
                    console.log(2);

                }
            });
        },
        
        onSubmit: function () {
//                var id = this.elements["id"].value;
        var name = this.name;
        var description = this.description;
        var self = this;
        $.ajax({
            url: "api/posts",
            contentType: "application/json",
            method: "POST",
            data: JSON.stringify({
            name: name,
            description: description
            }),
            success: function (post) {
                self.items.push(post);
                }
            });
        }
    }
};
    

// 2. Определение путей
// Каждый путь должен указывать на компонент
// "Компонентом" может быть как созданный через `Vue.extend()`
// полноценный конструктор, так и просто объект с настройками компонента
// Вложенные пути будут рассмотрены далее.
const routes = [
    { path: '/', component: Home },
    { path: '/blog', component: Blog },
    { path: '/works', component: Works },
    { path: '/contact', component: Contact },
    { path: '/about', component: About }
];

// 3. Создаём инстанс роутера с опцией `routes`
// Можно передать и другие опции, но пока не будем усложнять
const router = new VueRouter({
  routes 
});

// 4. Создаём и монтируем корневой инстанс Vue нашего приложения.
// Удостоверьтесь, что передали инстанс роутера в опции `router`,
// что позволит приложению знать о его наличии
const app = new Vue({
  router: router,
  el: '#main-page',
  data: {
     
  }
});

//var App = new Vue({
//el: '#main-page',
//        data: {
//        items: [],
//                main: true,
//                blog: false,
//                about: false,
//                works: false,
//                contact: false,
//                description: '',
//                name: ''
//        },
//        methods: {
//        GetPosts: function () {
//        this.blog = true;
//        this.main = false;
//        var self = this;
//        $.ajax({
//        url: "api/posts",
//                type: "GET",
//                contentType: "application/json",
//                success: function (posts) {
//                self.items = posts;
//                }
//        });
//        },
////        GetPost: function (id) {
////            $.ajax({
////                url: "/api/posts/" + id,
////                type: "GET",
////                contentType: "application/json",
////                success: function (post) {
////                    var form = document.forms["postsForm"];
////                    form.elements["id"].value = post._id;
////                    form.elements["name"].value = post.name;
////                    form.elements["description"].value = post.description;
////                }
////            });
////        },
////        CreatePost: function () {
////
////            console.log(this.name, this.description)
////            $.ajax({
////                url: "api/posts",
////                contentType: "application/json",
////                method: "POST",
////                data: JSON.stringify({
////                    name: this.name,
////                    description: this.description
////                }),
////                success: function (post) {
////
////
////                }
////            })
////        },
//        onSubmit: function () {
////                var id = this.elements["id"].value;
//        var name = this.name;
//        var description = this.description;
//        var self = this;
//        $.ajax({
//        url: "api/posts",
//                contentType: "application/json",
//                method: "POST",
//                data: JSON.stringify({
//                name: name,
//                        description: description
//                }),
//                success: function (post) {
//                self.items.push(post)
//                }
//        })
//        },
////        EditUser:  function (userId, userName, userAge) {
////                $.ajax({
////                    url: "api/users",
////                    contentType: "application/json",
////                    method: "PUT",
////                    data: JSON.stringify({
////                        id: userId,
////                        name: userName,
////                        age: userAge
////                    }),
////                    success: function (user) {
////                        reset();
////                        console.log(user);
//////                        $("tr[data-rowid='" + user._id + "']").replaceWith(row(user));
////                    }
////                })
////            }
//                            }
//                    });
////            function EditUser(userId, userName, userAge) {
////                $.ajax({
////                    url: "api/users",
////                    contentType: "application/json",
////                    method: "PUT",
////                    data: JSON.stringify({
////                        id: userId,
////                        name: userName,
////                        age: userAge
////                    }),
////                    success: function (user) {
////                        reset();
////                        console.log(user);
////                        $("tr[data-rowid='" + user._id + "']").replaceWith(row(user));
////                    }
////                })
////            }
//// сброс формы
////            function reset() {
////                var form = document.forms["userForm"];
////                form.reset();
////                form.elements["id"].value = 0;
////            }
//// Удаление пользователя
////            function DeleteUser(id) {
////                $.ajax({
////                    url: "api/users/" + id,
////                    contentType: "application/json",
////                    method: "DELETE",
////                    success: function (user) {
////                        console.log(user);
////                        $("tr[data-rowid='" + user._id + "']").remove();
////                    }
////                })
////            }
//// сброс значений формы
////            $("#reset").click(function (e) {
////
////                e.preventDefault();
////                reset();
////            })
//// нажимаем на ссылку Изменить
////            $("body").on("click", ".editLink", function () {
////                var id = $(this).data("id");
////                GetUser(id);
////            })
//// нажимаем на ссылку Удалить
////            $("body").on("click", ".removeLink", function () {
////                var id = $(this).data("id");
////                DeleteUser(id);
////            })
//

        </script>
    </body>
</html>